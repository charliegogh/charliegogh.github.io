(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{216:function(a,t,s){"use strict";s.r(t);var e=s(0),r=Object(e.a)({},(function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"nginx-相关配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#nginx-相关配置"}},[a._v("#")]),a._v(" nginx 相关配置")]),a._v(" "),s("h2",{attrs:{id:"官网"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#官网"}},[a._v("#")]),a._v(" 官网")]),a._v(" "),s("p",[s("a",{attrs:{href:"nginx.org"}},[a._v("官网")]),a._v(" "),s("a",{attrs:{href:"https://mp.weixin.qq.com/s/J14CrLs5OfetO6AcUT3kjQ",target:"_blank",rel:"noopener noreferrer"}},[a._v("nginx 反向代理和负载均衡策略实战案例"),s("OutboundLink")],1)]),a._v(" "),s("h2",{attrs:{id:"配置环境"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置环境"}},[a._v("#")]),a._v(" 配置环境")]),a._v(" "),s("ul",[s("li",[a._v("系统环境:centOS")]),a._v(" "),s("li",[a._v("用yum进行安装必要程序")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("    yum -y install gcc gcc-c++ autoconf pcre-devel make automake\n    yum -y install wget httpd-tools vim\n")])])]),s("h2",{attrs:{id:"快速搭建nginx"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#快速搭建nginx"}},[a._v("#")]),a._v(" 快速搭建nginx")]),a._v(" "),s("h3",{attrs:{id:"安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[a._v("#")]),a._v(" 安装")]),a._v(" "),s("ol",[s("li",[a._v("查看yum是否存在:")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("yum list | grep nginx\n")])])]),s("ol",{attrs:{start:"2"}},[s("li",[a._v("使用需求的yum版本")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("vim /etc/yum.repos.d/nginx.repo\n")])])]),s("ol",{attrs:{start:"3"}},[s("li",[a._v("终端输入nginx官网提供的源,注意设置对应的系统和版本号")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("[nginx]\nname=nginx repo\nbaseurl=http://nginx.org/packages/centos/7/$basearch/\ngpgcheck=0\nenabled=1\n\nyum install nginx \n")])])]),s("h2",{attrs:{id:"基本的文件配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#基本的文件配置"}},[a._v("#")]),a._v(" 基本的文件配置")]),a._v(" "),s("h3",{attrs:{id:"查看nginx安装目录"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#查看nginx安装目录"}},[a._v("#")]),a._v(" 查看nginx安装目录:")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v(" rpm -ql nginx   \n")])])]),s("p",[a._v("nginx.conf为nginx总的配置文件，搭建服务器需要经常去调整")]),a._v(" "),s("h3",{attrs:{id:"服务器启动、停止、重启"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#服务器启动、停止、重启"}},[a._v("#")]),a._v(" 服务器启动、停止、重启")]),a._v(" "),s("ul",[s("li",[a._v("centos7版本中直接去使用nginx启动服务")]),a._v(" "),s("li",[a._v("使用systemctl命令启动:")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("systemctl start nginx.service\n")])])]),s("h4",{attrs:{id:"查询nginx是否被启动"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#查询nginx是否被启动"}},[a._v("#")]),a._v(" 查询nginx是否被启动")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("ps aux | grep nginx\n")])])]),s("h4",{attrs:{id:"停止nginx"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#停止nginx"}},[a._v("#")]),a._v(" 停止nginx")]),a._v(" "),s("ol",[s("li",[a._v("立即停止服务")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("nginx  -s stop\n")])])]),s("ol",{attrs:{start:"2"}},[s("li",[a._v("从容停止服务")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("nginx -s quit\n")])])]),s("ol",{attrs:{start:"3"}},[s("li",[a._v("killall 方法杀死进程")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("killall nginx\n")])])]),s("ol",{attrs:{start:"4"}},[s("li",[a._v("systemctl 停止")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("systemctl stop nginx.service\n")])])]),s("h4",{attrs:{id:"重启"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#重启"}},[a._v("#")]),a._v(" 重启")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("systemctl restart nginx.service\n")])])]),s("h4",{attrs:{id:"重新载入配置文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#重新载入配置文件"}},[a._v("#")]),a._v(" 重新载入配置文件")]),a._v(" "),s("p",[a._v("重新编写或修改nginx配置文件后进行重新载入")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("nginx -s reload\n")])])]),s("h2",{attrs:{id:"自定义错误页面和访问设置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#自定义错误页面和访问设置"}},[a._v("#")]),a._v(" 自定义错误页面和访问设置")]),a._v(" "),s("p",[a._v("类别:多错误指向一个页面\n把错误码换成一个地址:")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("error_page  404 http://xxx;\n")])])]),s("h3",{attrs:{id:"访问控制"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#访问控制"}},[a._v("#")]),a._v(" 访问控制")]),a._v(" "),s("p",[a._v("只允许特定主机访问")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v(" location / {\n        deny   123.9.51.42;\n        allow  45.76.202.231;\n    }\n")])])]),s("h2",{attrs:{id:"权限问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#权限问题"}},[a._v("#")]),a._v(" 权限问题")]),a._v(" "),s("h3",{attrs:{id:"指令的优先级"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#指令的优先级"}},[a._v("#")]),a._v(" 指令的优先级")]),a._v(" "),s("p",[a._v("先出现的设置会覆盖后出现的设置")]),a._v(" "),s("h3",{attrs:{id:"复杂访问控制权限匹配"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#复杂访问控制权限匹配"}},[a._v("#")]),a._v(" 复杂访问控制权限匹配")]),a._v(" "),s("p",[a._v("设置需求：对网站下的图片目录可以去访问，对于admin目录则只允许公司内部固定IP去访问")]),a._v(" "),s("h3",{attrs:{id:"详细配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#详细配置"}},[a._v("#")]),a._v(" 详细配置")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("location =/img{\n        allow all;\n    }\n    location =/admin{\n        deny all;\n    }\n= 代表精确匹配\n")])])]),s("h2",{attrs:{id:"反向代理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#反向代理"}},[a._v("#")]),a._v(" 反向代理")]),a._v(" "),s("blockquote",[s("p",[a._v("在C端和S端增加提供特定功能的服务器，即为代理服务器")])]),a._v(" "),s("h3",{attrs:{id:"理解正向代理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#理解正向代理"}},[a._v("#")]),a._v(" 理解正向代理")]),a._v(" "),s("p",[a._v("最典型的正向代理工具:翻墙工具")]),a._v(" "),s("ul",[s("li",[a._v("原理:把不让访问的服务器代理到一个可以访问该网站的代理服务器上\n一般叫做proxy服务器 再去转发给客户")])]),a._v(" "),s("h3",{attrs:{id:"理解反向代理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#理解反向代理"}},[a._v("#")]),a._v(" 理解反向代理")]),a._v(" "),s("ul",[s("li",[a._v("原理：客户端发送的请求，想要去访问sever服务器上的内容，发送的内容被发送到代理\n服务器上，这个代理服务器再把请求发送到自己设置好的内部服务器上，用户真实获得\n的内容就在这些设置好的服务器上。")])]),a._v(" "),s("h4",{attrs:{id:"设置反向代理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#设置反向代理"}},[a._v("#")]),a._v(" 设置反向代理")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("server{\n        listen 80;\n        server_name nginx2.jspang.com;\n        location / {\n               proxy_pass http://jspang.com;\n        }\n}\n")])])]),s("h2",{attrs:{id:"虚拟主机"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#虚拟主机"}},[a._v("#")]),a._v(" 虚拟主机")]),a._v(" "),s("ul",[s("li",[a._v("原理：一台物理主机划分多个磁盘空间，每个磁盘空间都是一个虚拟主机，每台虚拟主机都可以提供web服务，互补干扰。")]),a._v(" "),s("li",[a._v("结果：用户可以利用虚拟主机把多个不同域名的网站部署到同一台服务器上。")]),a._v(" "),s("li",[a._v("基于端口号配置虚拟主机")])]),a._v(" "),s("h2",{attrs:{id:"适配pc和移动设备"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#适配pc和移动设备"}},[a._v("#")]),a._v(" 适配pc和移动设备")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("    root /usr/share/nginx/pc;\n    if ($http_user_agent ~* '(Android|webOS|iPhone|iPod|BlackBerry)') {\n    root /usr/share/nginx/mobile;\n    }\n    index index.html;\n")])])]),s("p",[a._v("$http_user_agent的使用：可获取到请求客户端的userAgent")]),a._v(" "),s("h2",{attrs:{id:"gzip压缩的设置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#gzip压缩的设置"}},[a._v("#")]),a._v(" gzip压缩的设置")]),a._v(" "),s("p",[a._v("经过gzip压缩之后，页面大小会变成原来的30%甚至更小,需要浏览器和服务器的同时支持")]),a._v(" "),s("ul",[s("li",[a._v("简单配置:")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("    gzip  on; # 开启压缩 \n    gzip_types text/plain application/javascript text/css;\n")])])]),s("h2",{attrs:{id:"node安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#node安装"}},[a._v("#")]),a._v(" node安装")]),a._v(" "),s("ul",[s("li",[a._v("安装:yum install nodejs")]),a._v(" "),s("li",[a._v("更新:npm install -g n")])]),a._v(" "),s("h2",{attrs:{id:"使用域名设置虚拟主机"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用域名设置虚拟主机"}},[a._v("#")]),a._v(" 使用域名设置虚拟主机")])])}),[],!1,null,null,null);t.default=r.exports}}]);